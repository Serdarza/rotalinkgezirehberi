<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RotaLink – Şehir Ara</title>
<meta name="theme-color" content="#f7faff" />
<style>
:root{
  --bg:#f7faff;--card:#fff;--text:#0f172a;--mut:#475569;--bd:#e2e8f0;
  --b1:#0ea5e9;--b2:#22d3ee;--ok:#22c55e;--go:#10b981;--warn:#f59e0b;
  --share1:#a78bfa;--share2:#f472b6
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto}
a{text-decoration:none;color:inherit}
.container{max-width:1100px;margin:auto;padding:18px}
header{display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--bd);background:#fff}
.logo{display:flex;gap:10px;align-items:center;font-weight:800}
.badge{width:30px;height:30px;border-radius:10px;display:grid;place-items:center;background:linear-gradient(135deg,var(--b1),var(--b2));color:#00131a}
nav{display:flex;gap:14px;color:var(--mut)}
.hero{display:grid;grid-template-columns:1fr;gap:14px;margin-top:16px}
.card{background:var(--card);border:1px solid var(--bd);border-radius:12px;padding:16px}
.hero h1{margin:0 0 6px;font-size:22px}
.hero .btn-store{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;border:0;background:linear-gradient(135deg,var(--b1),var(--b2));color:#00131a;font-weight:800}

.search{margin-top:12px}
.inputwrap{position:relative}
input[type="text"]{width:100%;padding:12px 40px 12px 12px;border-radius:10px;border:1px solid #cbd5e1;background:#fff}
.clearbtn{position:absolute;right:8px;top:50%;transform:translateY(-50%);border:0;background:#eef2f7;width:28px;height:28px;border-radius:8px;font-weight:900;color:#334155;cursor:pointer}

.tabs{margin-top:14px;border-bottom:1px solid var(--bd);display:flex;gap:6px;flex-wrap:wrap}
.tab{padding:8px 14px;border:1px solid var(--bd);border-bottom:0;border-radius:10px 10px 0 0;background:#fff;color:#0f172a;cursor:pointer;font-weight:700}
.tab.active{background:linear-gradient(135deg,#f8fafc,#fff)}
.tabcontent{display:none;padding:12px;border:1px solid var(--bd);border-top:0;border-radius:0 0 12px 12px;background:#fff}
.tabcontent.active{display:block}

.list{display:grid;gap:10px}
.item{border:1px solid var(--bd);border-radius:10px;padding:10px;background:#fff;display:flex;align-items:center;justify-content:space-between;gap:12px}
.title{font-weight:700;font-size:15px;flex:1;min-width:160px}
.actions{display:flex;gap:8px;flex-wrap:wrap}
.btn{display:inline-flex;align-items:center;justify-content:center;padding:8px 12px;border-radius:10px;border:0;font-weight:800;font-size:14px;color:#0b1320;background:#f1f5f9}
.btn.call{background:linear-gradient(135deg,#38bdf8,#22d3ee);color:#00131a}
.btn.share{background:linear-gradient(135deg,var(--share1),var(--share2));color:#111827}
.btn.go{background:linear-gradient(135deg,#34d399,#22c55e);color:#0b1320}
.btn.view{background:linear-gradient(135deg,#fde68a,var(--warn));color:#111827}

.empty{color:var(--mut);font-size:13px}

footer{margin-top:32px;padding-top:14px;border-top:1px solid var(--bd);color:var(--mut);display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px}
@media(max-width:640px){
  .item{flex-direction:column;align-items:flex-start}
  .actions{width:100%}
}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo"><div class="badge">RL</div><span>RotaLink</span></div>
    <nav><a href="#sehirara">Şehir Ara</a><a href="#ozellikler">Özellikler</a><a href="#indir">İndir</a><a href="#iletisim">İletişim</a></nav>
  </header>

  <section class="hero card" id="ozellikler">
    <h1>RotaLink ile şehirde en doğru noktaya tek dokunuş.</h1>
    <p>Misafirhaneler, gezi noktaları, yerel yemekler ve sosyal tesisler. Arayın, <strong>Ara</strong> ile telefon edin, <strong>Paylaş</strong> ile link gönderin, <strong>Git</strong> ile haritada açın.</p>
    <a class="btn-store" id="indir" href="https://play.google.com/store/apps/details?id=com.serdarza.rotalink" target="_blank" rel="noopener">Google Play’den indir</a>
  </section>

  <section class="search" id="sehirara">
    <h2>Şehir Ara</h2>
    <div class="inputwrap">
      <input id="q" list="iller" placeholder="örn. Düzce, Kayseri, Kocaeli" autocomplete="off" />
      <button class="clearbtn" id="clearBtn" title="Temizle">×</button>
      <datalist id="iller"></datalist>
    </div>

    <div class="tabs" id="tabs" style="display:none">
      <div class="tab" data-tab="tesis">Tesis</div>
      <div class="tab" data-tab="gezi">Gezi</div>
      <div class="tab" data-tab="yemek">Yemek</div>
      <div class="tab" data-tab="sosyal">Sosyal</div>
    </div>

    <div class="tabcontent" id="tab-tesis"><div class="empty">Sonuç yok.</div></div>
    <div class="tabcontent" id="tab-gezi"><div class="empty">Sonuç yok.</div></div>
    <div class="tabcontent" id="tab-yemek"><div class="empty">Sonuç yok.</div></div>
    <div class="tabcontent" id="tab-sosyal"><div class="empty">Sonuç yok.</div></div>
  </section>

  <footer>
    <div>© <span id="yil"></span> RotaLink</div>
    <div><a href="mailto:rotalinkinfo@gmail.com">rotalinkinfo@gmail.com</a></div>
  </footer>
</div>

<script>
document.getElementById('yil').textContent = new Date().getFullYear();

const S = {ready:false,data:[],gezi:[],yemek:[],sosyal:[],citySet:new Set()};
async function loadAll(){
  if(S.ready) return;
  const files = ['data.json','gezi.json','yemek.json','sosyal.json'];
  const [d,g,y,s] = await Promise.all(files.map(f=>fetch(f,{cache:'no-store'}).then(r=>r.ok?r.json():[]).catch(()=>[])));
  S.data=d; S.gezi=g; S.yemek=y; S.sosyal=s; S.ready=true;
  // şehir önerileri
  [...d,...g,...y,...s].forEach(it=>{ if(it && it.il) S.citySet.add(it.il.trim()); });
  const dl = document.getElementById('iller');
  dl.innerHTML = [...S.citySet].sort((a,b)=>a.localeCompare(b,'tr')).map(x=>`<option value="${x}">`).join('');
}

const qEl = document.getElementById('q');
const clearBtn = document.getElementById('clearBtn');
const tabsBar = document.getElementById('tabs');
const tabBtns = [...document.querySelectorAll('.tab')];

function phoneHref(t){ const d=String(t||'').replace(/[^0-9+]/g,''); return d?`tel:${d}`:''; }
function mapsHref(il, isim, lat, lng){
  if(lat && lng) return `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`;
  return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent((il||'')+' '+(isim||''))}`;
}
function googleHref(isim, il){ return `https://www.google.com/search?q=${encodeURIComponent((isim||'')+' '+(il||''))}`; }

function mountList(el, items, type){
  el.innerHTML = '';
  if(!items.length){ el.innerHTML = '<div class="empty">Sonuç yok.</div>'; return; }
  const list = document.createElement('div'); list.className='list';
  items.forEach(it=>{
    const row = document.createElement('div'); row.className='item';
    const title = document.createElement('div'); title.className='title'; title.textContent = it.isim || 'İsimsiz';
    const acts = document.createElement('div'); acts.className='actions';
    if(type==='tesis'){
      const tel = phoneHref(it.telefon);
      const maps = mapsHref(it.il, it.isim, it.latitude, it.longitude);
      acts.innerHTML =
        (tel?`<a class="btn call" href="${tel}">Ara</a>`:`<button class="btn" disabled>Telefon yok</button>`) +
        `<button class="btn share" onclick='navigator.share?navigator.share({title:"${(it.isim||'Konum').replace(/"/g,'&quot;')}",url:"${maps}"}) : navigator.clipboard.writeText("${maps}")'>Paylaş</button>`+
        `<a class="btn go" href="${maps}" target="_blank" rel="noopener">Git</a>`;
    }else{
      const url = googleHref(it.isim, it.il);
      acts.innerHTML = `<a class="btn view" href="${url}" target="_blank" rel="noopener">İncele</a>`;
    }
    row.appendChild(title); row.appendChild(acts); list.appendChild(row);
  });
  el.appendChild(list);
}

function activate(tabName){
  tabBtns.forEach(b=>b.classList.toggle('active', b.dataset.tab===tabName));
  ['tesis','gezi','yemek','sosyal'].forEach(name=>{
    const el = document.getElementById('tab-'+name);
    el.classList.toggle('active', name===tabName);
  });
}

tabBtns.forEach(b=>b.addEventListener('click', ()=>activate(b.dataset.tab)));

async function run(){
  await loadAll();
  const q = qEl.value.trim().toLowerCase();
  if(!q){
    tabsBar.style.display='none';
    ['tab-tesis','tab-gezi','tab-yemek','tab-sosyal'].forEach(id=>{
      const el=document.getElementById(id); el.innerHTML='<div class="empty">Şehir yazın.</div>'; el.classList.remove('active');
    });
    tabBtns.forEach(b=>b.classList.remove('active'));
    return;
  }
  const f = x => (x.il||'').toLowerCase().includes(q);
  mountList(document.getElementById('tab-tesis'), S.data.filter(f), 'tesis');
  mountList(document.getElementById('tab-gezi'), S.gezi.filter(f), 'gezi');
  mountList(document.getElementById('tab-yemek'), S.yemek.filter(f), 'yemek');
  mountList(document.getElementById('tab-sosyal'), S.sosyal.filter(f), 'sosyal');

  // İlk aramada sekmeler gösterilsin, varsayılan TESİS açık
  tabsBar.style.display='';
  activate('tesis');
}

qEl.addEventListener('input', run);
clearBtn.addEventListener('click', ()=>{ qEl.value=''; qEl.focus(); run(); });

// İlk yüklemede şehir listesi
loadAll();
</script>
</body>
</html>
