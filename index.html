<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RotaLink – Şehirde keşfet, yerini bul</title>
  <meta name="theme-color" content="#f3f6fb" />
  <style>
    :root{--bg:#f7faff;--card:#ffffff;--text:#0f172a;--muted:#475569;--brand:#0ea5e9;--accent:#22d3ee}
    *{box-sizing:border-box}
    body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,sans-serif}
    header{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;border-bottom:1px solid #e2e8f0;background:#fff}
    .logo{display:flex;align-items:center;gap:10px;font-weight:800}
    nav{display:flex;gap:16px}
    nav a{color:var(--muted);text-decoration:none}
    .search-box{padding:16px}
    .search-box input{width:100%;padding:10px;border-radius:8px;border:1px solid #cbd5e1}
    .tabs{display:flex;border-bottom:1px solid #e2e8f0;margin-top:12px}
    .tab{flex:1;text-align:center;padding:10px;cursor:pointer;font-weight:600;color:var(--muted)}
    .tab.active{color:#fff;background:var(--brand)}
    .tab-content{display:none;padding:12px}
    .tab-content.active{display:block}
    .item{background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:10px;margin-bottom:8px}
    .item h4{margin:0 0 4px;font-size:15px;color:var(--brand)}
    .item p{margin:0;font-size:14px;color:var(--muted)}
    .actions{display:flex;gap:8px;margin-top:6px}
    .btn{flex:1;padding:6px 10px;font-size:13px;font-weight:600;color:#fff;border:none;border-radius:6px;cursor:pointer;text-align:center}
    .btn.call{background:#10b981}
    .btn.share{background:#3b82f6}
    .btn.map{background:#f59e0b}
    footer{margin-top:32px;padding:12px 20px;border-top:1px solid #e2e8f0;font-size:14px;color:var(--muted);display:flex;justify-content:space-between}
  </style>
</head>
<body>
  <header>
    <div class="logo">RotaLink</div>
    <nav>
      <a href="#sehirara">Şehir Ara</a>
      <a href="#iletisim">İletişim</a>
    </nav>
  </header>

  <section id="sehirara" class="search-box">
    <input type="text" id="searchInput" placeholder="Şehir adı yazın..." />
    <div class="tabs">
      <div class="tab" data-target="misafirhane">Tesis</div>
      <div class="tab" data-target="gezi">Gezi</div>
      <div class="tab" data-target="yemek">Yemek</div>
      <div class="tab" data-target="sosyal">Sosyal</div>
    </div>
    <div id="misafirhane" class="tab-content"></div>
    <div id="gezi" class="tab-content"></div>
    <div id="yemek" class="tab-content"></div>
    <div id="sosyal" class="tab-content"></div>
  </section>

  <section id="iletisim" class="search-box">
    <h3>İletişim</h3>
    <p>e-posta: <a href="mailto:destek@rotalink.app">destek@rotalink.app</a></p>
  </section>

  <footer>
    <span>© <span id="yil"></span> RotaLink</span>
    <span>Açık kaynak: yakında</span>
  </footer>

  <script>
    document.getElementById('yil').textContent = new Date().getFullYear();

    const input = document.getElementById('searchInput');
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab=>{
      tab.addEventListener('click',()=>{
        tabs.forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.target).classList.add('active');
      });
    });

    async function loadJson(file){
      try{
        const res=await fetch(file);
        return await res.json();
      }catch(e){console.error(file+' okunamadı',e);return[]}
    }

    input.addEventListener('input',async()=>{
      const val=input.value.trim().toLowerCase();
      if(!val){document.querySelectorAll('.tab-content').forEach(c=>c.innerHTML='');return;}

      const [misafir,gezi,yemek,sosyal]=await Promise.all([
        loadJson('data.json'),
        loadJson('gezi.json'),
        loadJson('yemek.json'),
        loadJson('sosyal.json')
      ]);

      renderMisafir(misafir.filter(i=>(i.il||'').toLowerCase().includes(val)));
      renderList('gezi',gezi.filter(i=>(i.il||'').toLowerCase().includes(val)));
      renderList('yemek',yemek.filter(i=>(i.il||'').toLowerCase().includes(val)));
      renderList('sosyal',sosyal.filter(i=>(i.il||'').toLowerCase().includes(val)));
    });

    function renderMisafir(list){
      const box=document.getElementById('misafirhane');
      box.innerHTML='';
      list.forEach(item=>{
        const mapsUrl=item.latitude&&item.longitude?
          `https://www.google.com/maps/search/?api=1&query=${item.latitude},${item.longitude}`:
          `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.il+' '+item.isim)}`;
        const telDigits=String(item.telefon||'').replace(/[^0-9+]/g,'');
        const telUrl=telDigits?`tel:${telDigits}`:'';
        const div=document.createElement('div');
        div.className='item';
        div.innerHTML=`<h4>${item.isim}</h4>
          <div class="actions">
            ${telUrl?`<a class='btn call' href='${telUrl}'>Ara</a>`:''}
            <button class='btn share' onclick='navigator.share?navigator.share({title:"${item.isim}",url:"${mapsUrl}"}):navigator.clipboard.writeText("${mapsUrl}").then(()=>alert("Kopyalandı"))'>Paylaş</button>
            <a class='btn map' href='${mapsUrl}' target='_blank'>Git</a>
          </div>`;
        box.appendChild(div);
      });
    }

    function renderList(id,list){
      const box=document.getElementById(id);
      box.innerHTML='';
      list.forEach(item=>{
        const div=document.createElement('div');
        div.className='item';
        div.innerHTML=`<h4>${item.isim}</h4><p>${item.aciklama||''}</p>`;
        box.appendChild(div);
      });
    }
  </script>
</body>
</html>
